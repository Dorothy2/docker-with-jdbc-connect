USE kconnect;

CREATE TABLE CURRENCY_PROTO(
  EVENT_TIME char(26) NOT NULL,
  EFFECTIVE_TIME char(26) NOT NULL,
  PROVIDER_ID varchar(20) NOT NULL,
  CLIENT_ID varchar(20) NOT NULL,
  CRRNCY_CD varchar(3) NOT NULL,
  VERSION int NULL,
  REVISION int NULL,
  CRRNCY_NAME varchar(60) NOT NULL,
  CALC_PRECISION int NOT NULL,
  AVGPRICE_ROUND_OVRD int NULL,
  ISO_CRRNCY_CD varchar(3) NULL,
  CRRNCY_SEC_ID int NULL,
  EURO_FLAG char(1) NOT NULL,
  TRUNC_FLAG char(1) NOT NULL,
  PRIMARY KEY( CRRNCY_CD)
);

INSERT INTO CURRENCY_PROTO(EVENT_TIME, EFFECTIVE_TIME, PROVIDER_ID, CLIENT_ID, CRRNCY_CD, VERSION, REVISION, CRRNCY_NAME, CALC_PRECISION, AVGPRICE_ROUND_OVRD, ISO_CRRNCY_CD, CRRNCY_SEC_ID, EURO_FLAG, TRUNC_FLAG)
VALUES('0001-01-01T00:00:000-05:00', '0001-01-01T00:00:000-05:00', 'CRIMS', 'test-tenant', 'CHF', 2, 0, 'Swiss Franc', 2, null, 'CHF', 1250008004, 'N', 'N');

INSERT INTO CURRENCY_PROTO(EVENT_TIME, EFFECTIVE_TIME, PROVIDER_ID, CLIENT_ID, CRRNCY_CD, VERSION, REVISION, CRRNCY_NAME, CALC_PRECISION, AVGPRICE_ROUND_OVRD, ISO_CRRNCY_CD, CRRNCY_SEC_ID, EURO_FLAG, TRUNC_FLAG)
VALUES('0001-01-01T00:00:000-05:00', '0001-01-01T00:00:000-05:00', 'CRIMS', 'test-tenant', 'CSD', 2, 0, 'Serbian Dinar', 2, null, 'CHF', null, 'N', 'N');

INSERT INTO CURRENCY_PROTO(EVENT_TIME, EFFECTIVE_TIME, PROVIDER_ID, CLIENT_ID, CRRNCY_CD, VERSION, REVISION, CRRNCY_NAME, CALC_PRECISION, AVGPRICE_ROUND_OVRD, ISO_CRRNCY_CD, CRRNCY_SEC_ID, EURO_FLAG, TRUNC_FLAG)
VALUES('0001-01-01T00:00:000-05:00', '0001-01-01T00:00:000-05:00', 'CRIMS', 'test-tenant', 'XSU', 2, 0, 'Sucre', 2, null, 'CHF', null, 'N', 'N');

INSERT INTO CURRENCY_PROTO(EVENT_TIME, EFFECTIVE_TIME, PROVIDER_ID, CLIENT_ID, CRRNCY_CD, VERSION, REVISION, CRRNCY_NAME, CALC_PRECISION, AVGPRICE_ROUND_OVRD, ISO_CRRNCY_CD, CRRNCY_SEC_ID, EURO_FLAG, TRUNC_FLAG)
VALUES('0001-01-01T00:00:000-05:00', '0001-01-01T00:00:000-05:00', 'CRIMS', 'test-tenant', 'BOB', 2, 0, 'Bolivian Boliviano', 2, null, 'BOB', null, 'N', 'N');

INSERT INTO CURRENCY_PROTO(EVENT_TIME, EFFECTIVE_TIME, PROVIDER_ID, CLIENT_ID, CRRNCY_CD, VERSION, REVISION, CRRNCY_NAME, CALC_PRECISION, AVGPRICE_ROUND_OVRD, ISO_CRRNCY_CD, CRRNCY_SEC_ID, EURO_FLAG, TRUNC_FLAG)
VALUES('0001-01-01T00:00:000-05:00', '0001-01-01T00:00:000-05:00', 'CRIMS', 'test-tenant', 'FKP', 2, 0, 'Falkland Islands Pound', 2, null, 'FKP', null, 'N', 'N');

INSERT INTO CURRENCY_PROTO(EVENT_TIME, EFFECTIVE_TIME, PROVIDER_ID, CLIENT_ID, CRRNCY_CD, VERSION, REVISION, CRRNCY_NAME, CALC_PRECISION, AVGPRICE_ROUND_OVRD, ISO_CRRNCY_CD, CRRNCY_SEC_ID, EURO_FLAG, TRUNC_FLAG)
VALUES('0001-01-01T00:00:000-05:00', '0001-01-01T00:00:000-05:00', 'CRIMS', 'test-tenant', 'FJD', 2, 0, 'Fiji Dollar', 2, null, 'FJD', null, 'N', 'N');

INSERT INTO CURRENCY_PROTO(EVENT_TIME, EFFECTIVE_TIME, PROVIDER_ID, CLIENT_ID, CRRNCY_CD, VERSION, REVISION, CRRNCY_NAME, CALC_PRECISION, AVGPRICE_ROUND_OVRD, ISO_CRRNCY_CD, CRRNCY_SEC_ID, EURO_FLAG, TRUNC_FLAG)
VALUES('0001-01-01T00:00:000-05:00', '0001-01-01T00:00:000-05:00', 'CRIMS', 'test-tenant', 'CUC', 2, 0, 'Peso Convertible', 2, null, 'CUC', null, 'N', 'N');

INSERT INTO CURRENCY_PROTO(EVENT_TIME, EFFECTIVE_TIME, PROVIDER_ID, CLIENT_ID, CRRNCY_CD, VERSION, REVISION, CRRNCY_NAME, CALC_PRECISION, AVGPRICE_ROUND_OVRD, ISO_CRRNCY_CD, CRRNCY_SEC_ID, EURO_FLAG, TRUNC_FLAG)
VALUES('0001-01-01T00:00:000-05:00', '0001-01-01T00:00:000-05:00', 'CRIMS', 'test-tenant', 'HRK', 2, 0, 'Crotian Kuna', 2, null, 'HRK', null, 'N', 'N');

INSERT INTO CURRENCY_PROTO(EVENT_TIME, EFFECTIVE_TIME, PROVIDER_ID, CLIENT_ID, CRRNCY_CD, VERSION, REVISION, CRRNCY_NAME, CALC_PRECISION, AVGPRICE_ROUND_OVRD, ISO_CRRNCY_CD, CRRNCY_SEC_ID, EURO_FLAG, TRUNC_FLAG)
VALUES('0001-01-01T00:00:000-05:00', '0001-01-01T00:00:000-05:00', 'CRIMS', 'test-tenant', 'STD', 2, 0, 'San ome, Principe Dobra', 2, null, 'STD', null, 'N', 'N');

ALTER TABLE CURRENCY_PROTO ADD COLUMN COMPOSITE_KEY VARCHAR(50);

UPDATE CURRENCY_PROTO SET COMPOSITE_KEY = CONCAT(PROVIDER_ID , '.', CLIENT_ID, '.', CRRNCY_CD);
